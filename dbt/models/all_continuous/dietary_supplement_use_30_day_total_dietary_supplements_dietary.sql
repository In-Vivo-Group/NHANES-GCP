SELECT
SEQN as respondent_sequence_number,
WHEN DSDCOUNT IS NOT NULL THEN DSDCOUNTWHEN DSDCOUNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_dietary_supplements_taken,
WHEN DSDANCNT IS NOT NULL THEN DSDANCNTWHEN DSDANCNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_antacids_taken,
CASE
        WHEN DSD010 = 1 THEN 'Yes' 
WHEN DSD010 = 2 THEN 'No' 
WHEN DSD010 = 7 THEN 'Refused' 
WHEN DSD010 = 9 THEN 'Don\'t know' 
WHEN DSD010 IS NULL THEN NULL 
ELSE NULL 
 END as any_dietary_supplements_taken,
CASE
        WHEN DSD010AN = 1 THEN 'Yes' 
WHEN DSD010AN = 2 THEN 'No' 
WHEN DSD010AN = 7 THEN 'Refused' 
WHEN DSD010AN = 9 THEN 'Don\'t know' 
WHEN DSD010AN IS NULL THEN NULL 
ELSE NULL 
 END as any_antacids_taken,
WHEN DSQTKCAL IS NOT NULL THEN DSQTKCALWHEN DSQTKCAL IS NULL THEN NULL 
ELSE NULL 
 END as energy_kcal,
WHEN DSQTPROT IS NOT NULL THEN DSQTPROTWHEN DSQTPROT IS NULL THEN NULL 
ELSE NULL 
 END as protein_gm,
WHEN DSQTCARB IS NOT NULL THEN DSQTCARBWHEN DSQTCARB IS NULL THEN NULL 
ELSE NULL 
 END as carbohydrate_gm,
WHEN DSQTSUGR IS NOT NULL THEN DSQTSUGRWHEN DSQTSUGR IS NULL THEN NULL 
ELSE NULL 
 END as total_sugars_gm,
WHEN DSQTFIBE IS NOT NULL THEN DSQTFIBEWHEN DSQTFIBE IS NULL THEN NULL 
ELSE NULL 
 END as dietary_fiber_gm,
WHEN DSQTTFAT IS NOT NULL THEN DSQTTFATWHEN DSQTTFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_fat_gm,
WHEN DSQTSFAT IS NOT NULL THEN DSQTSFATWHEN DSQTSFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_saturated_fatty_acids_gm,
WHEN DSQTMFAT IS NOT NULL THEN DSQTMFATWHEN DSQTMFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_monounsaturated_fatty_acids_gm,
WHEN DSQTPFAT IS NOT NULL THEN DSQTPFATWHEN DSQTPFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_polyunsaturated_fatty_acids_gm,
WHEN DSQTCHOL IS NOT NULL THEN DSQTCHOLWHEN DSQTCHOL IS NULL THEN NULL 
ELSE NULL 
 END as cholesterol_mg,
WHEN DSQTLYCO IS NOT NULL THEN DSQTLYCOWHEN DSQTLYCO IS NULL THEN NULL 
ELSE NULL 
 END as lycopene_mcg,
WHEN DSQTLZ IS NOT NULL THEN DSQTLZWHEN DSQTLZ IS NULL THEN NULL 
ELSE NULL 
 END as lutein_zeaxanthin_mcg,
WHEN DSQTVB1 IS NOT NULL THEN DSQTVB1WHEN DSQTVB1 IS NULL THEN NULL 
ELSE NULL 
 END as thiamin_vitamin_b1_mg,
WHEN DSQTVB2 IS NOT NULL THEN DSQTVB2WHEN DSQTVB2 IS NULL THEN NULL 
ELSE NULL 
 END as riboflavin_vitamin_b2_mg,
WHEN DSQTNIAC IS NOT NULL THEN DSQTNIACWHEN DSQTNIAC IS NULL THEN NULL 
ELSE NULL 
 END as niacin_mg,
WHEN DSQTVB6 IS NOT NULL THEN DSQTVB6WHEN DSQTVB6 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b6_mg,
WHEN DSQTFA IS NOT NULL THEN DSQTFAWHEN DSQTFA IS NULL THEN NULL 
ELSE NULL 
 END as folic_acid_mcg,
WHEN DSQTFDFE IS NOT NULL THEN DSQTFDFEWHEN DSQTFDFE IS NULL THEN NULL 
ELSE NULL 
 END as folate_dfe_mcg,
WHEN DSQTCHL IS NOT NULL THEN DSQTCHLWHEN DSQTCHL IS NULL THEN NULL 
ELSE NULL 
 END as total_choline_mg,
WHEN DSQTVB12 IS NOT NULL THEN DSQTVB12WHEN DSQTVB12 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b12_mcg,
WHEN DSQTVC IS NOT NULL THEN DSQTVCWHEN DSQTVC IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_c_mg,
WHEN DSQTVK IS NOT NULL THEN DSQTVKWHEN DSQTVK IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_k_mcg,
WHEN DSQTVD IS NOT NULL THEN DSQTVDWHEN DSQTVD IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_d_d2_d3_mcg,
WHEN DSQTCALC IS NOT NULL THEN DSQTCALCWHEN DSQTCALC IS NULL THEN NULL 
ELSE NULL 
 END as calcium_mg,
WHEN DSQTPHOS IS NOT NULL THEN DSQTPHOSWHEN DSQTPHOS IS NULL THEN NULL 
ELSE NULL 
 END as phosphorus_mg,
WHEN DSQTMAGN IS NOT NULL THEN DSQTMAGNWHEN DSQTMAGN IS NULL THEN NULL 
ELSE NULL 
 END as magnesium_mg,
WHEN DSQTIRON IS NOT NULL THEN DSQTIRONWHEN DSQTIRON IS NULL THEN NULL 
ELSE NULL 
 END as iron_mg,
WHEN DSQTZINC IS NOT NULL THEN DSQTZINCWHEN DSQTZINC IS NULL THEN NULL 
ELSE NULL 
 END as zinc_mg,
WHEN DSQTCOPP IS NOT NULL THEN DSQTCOPPWHEN DSQTCOPP IS NULL THEN NULL 
ELSE NULL 
 END as copper_mg,
WHEN DSQTSODI IS NOT NULL THEN DSQTSODIWHEN DSQTSODI IS NULL THEN NULL 
ELSE NULL 
 END as sodium_mg,
WHEN DSQTPOTA IS NOT NULL THEN DSQTPOTAWHEN DSQTPOTA IS NULL THEN NULL 
ELSE NULL 
 END as potassium_mg,
WHEN DSQTSELE IS NOT NULL THEN DSQTSELEWHEN DSQTSELE IS NULL THEN NULL 
ELSE NULL 
 END as selenium_mcg,
WHEN DSQTCAFF IS NOT NULL THEN DSQTCAFFWHEN DSQTCAFF IS NULL THEN NULL 
ELSE NULL 
 END as caffeine_mg,
WHEN DSQTIODI IS NOT NULL THEN SAFE_CAST(DSQTIODI AS FLOAT64)WHEN DSQTIODI IS NULL THEN NULL 
ELSE NULL 
 END as iodine_mcg,
 FROM {{ ref('stg_dietary_supplement_use_30_day_total_dietary_supplements_dietary') }}