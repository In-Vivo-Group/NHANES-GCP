SELECT
SEQN as respondent_sequence_number, 

CASE
        WHEN DSDCOUNT IS NOT NULL THEN DSDCOUNT 
WHEN DSDCOUNT IS NOT NULL THEN DSDCOUNT 
WHEN DSDCOUNT IS NOT NULL THEN DSDCOUNT 
WHEN DSDCOUNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_dietary_supplements_taken, 

CASE
        WHEN DSDANCNT IS NOT NULL THEN DSDANCNT 
WHEN DSDANCNT IS NOT NULL THEN DSDANCNT 
WHEN DSDANCNT IS NOT NULL THEN DSDANCNT 
WHEN DSDANCNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_antacids_taken, 

CASE
        WHEN DSD010 = 1 THEN 'Yes' 
WHEN DSD010 = 2 THEN 'No' 
WHEN DSD010 = 7 THEN 'Refused' 
WHEN DSD010 = 9 THEN 'Dont know' 
WHEN DSD010 IS NULL THEN NULL 
ELSE NULL 
 END as any_dietary_supplements_taken, 

CASE
        WHEN DSD010AN = 1 THEN 'Yes' 
WHEN DSD010AN = 2 THEN 'No' 
WHEN DSD010AN = 7 THEN 'Refused' 
WHEN DSD010AN = 9 THEN 'Dont know' 
WHEN DSD010AN IS NULL THEN NULL 
ELSE NULL 
 END as any_antacids_taken, 

CASE
        WHEN DSQTKCAL IS NOT NULL THEN DSQTKCAL 
WHEN DSQTKCAL IS NULL THEN NULL 
ELSE NULL 
 END as energy_kcal, 

CASE
        WHEN DSQTPROT IS NOT NULL THEN DSQTPROT 
WHEN DSQTPROT IS NULL THEN NULL 
ELSE NULL 
 END as protein_gm, 

CASE
        WHEN DSQTCARB IS NOT NULL THEN DSQTCARB 
WHEN DSQTCARB IS NULL THEN NULL 
ELSE NULL 
 END as carbohydrate_gm, 

CASE
        WHEN DSQTSUGR IS NOT NULL THEN DSQTSUGR 
WHEN DSQTSUGR IS NULL THEN NULL 
ELSE NULL 
 END as total_sugars_gm, 

CASE
        WHEN DSQTFIBE IS NOT NULL THEN DSQTFIBE 
WHEN DSQTFIBE IS NULL THEN NULL 
ELSE NULL 
 END as dietary_fiber_gm, 

CASE
        WHEN DSQTTFAT IS NOT NULL THEN DSQTTFAT 
WHEN DSQTTFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_fat_gm, 

CASE
        WHEN DSQTSFAT IS NOT NULL THEN DSQTSFAT 
WHEN DSQTSFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_saturated_fatty_acids_gm, 

CASE
        WHEN DSQTMFAT IS NOT NULL THEN DSQTMFAT 
WHEN DSQTMFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_monounsaturated_fatty_acids_gm, 

CASE
        WHEN DSQTPFAT IS NOT NULL THEN DSQTPFAT 
WHEN DSQTPFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_polyunsaturated_fatty_acids_gm, 

CASE
        WHEN DSQTCHOL IS NOT NULL THEN DSQTCHOL 
WHEN DSQTCHOL IS NULL THEN NULL 
ELSE NULL 
 END as cholesterol_mg, 

CASE
        WHEN DSQTLYCO IS NOT NULL THEN DSQTLYCO 
WHEN DSQTLYCO IS NULL THEN NULL 
ELSE NULL 
 END as lycopene_mcg, 

CASE
        WHEN DSQTLZ IS NOT NULL THEN DSQTLZ 
WHEN DSQTLZ IS NULL THEN NULL 
ELSE NULL 
 END as lutein_zeaxanthin_mcg, 

CASE
        WHEN DSQTVB1 IS NOT NULL THEN DSQTVB1 
WHEN DSQTVB1 IS NULL THEN NULL 
ELSE NULL 
 END as thiamin_vitamin_b1_mg, 

CASE
        WHEN DSQTVB2 IS NOT NULL THEN DSQTVB2 
WHEN DSQTVB2 IS NULL THEN NULL 
ELSE NULL 
 END as riboflavin_vitamin_b2_mg, 

CASE
        WHEN DSQTNIAC IS NOT NULL THEN DSQTNIAC 
WHEN DSQTNIAC IS NULL THEN NULL 
ELSE NULL 
 END as niacin_mg, 

CASE
        WHEN DSQTVB6 IS NOT NULL THEN DSQTVB6 
WHEN DSQTVB6 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b6_mg, 

CASE
        WHEN DSQTFA IS NOT NULL THEN DSQTFA 
WHEN DSQTFA IS NULL THEN NULL 
ELSE NULL 
 END as folic_acid_mcg, 

CASE
        WHEN DSQTFDFE IS NOT NULL THEN DSQTFDFE 
WHEN DSQTFDFE IS NULL THEN NULL 
ELSE NULL 
 END as folate_dfe_mcg, 

CASE
        WHEN DSQTCHL IS NOT NULL THEN DSQTCHL 
WHEN DSQTCHL IS NULL THEN NULL 
ELSE NULL 
 END as total_choline_mg, 

CASE
        WHEN DSQTVB12 IS NOT NULL THEN DSQTVB12 
WHEN DSQTVB12 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b12_mcg, 

CASE
        WHEN DSQTVC IS NOT NULL THEN DSQTVC 
WHEN DSQTVC IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_c_mg, 

CASE
        WHEN DSQTVK IS NOT NULL THEN DSQTVK 
WHEN DSQTVK IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_k_mcg, 

CASE
        WHEN DSQTVD IS NOT NULL THEN DSQTVD 
WHEN DSQTVD IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_d_d2_d3_mcg, 

CASE
        WHEN DSQTCALC IS NOT NULL THEN DSQTCALC 
WHEN DSQTCALC IS NULL THEN NULL 
ELSE NULL 
 END as calcium_mg, 

CASE
        WHEN DSQTPHOS IS NOT NULL THEN DSQTPHOS 
WHEN DSQTPHOS IS NULL THEN NULL 
ELSE NULL 
 END as phosphorus_mg, 

CASE
        WHEN DSQTMAGN IS NOT NULL THEN DSQTMAGN 
WHEN DSQTMAGN IS NULL THEN NULL 
ELSE NULL 
 END as magnesium_mg, 

CASE
        WHEN DSQTIRON IS NOT NULL THEN DSQTIRON 
WHEN DSQTIRON IS NULL THEN NULL 
ELSE NULL 
 END as iron_mg, 

CASE
        WHEN DSQTZINC IS NOT NULL THEN DSQTZINC 
WHEN DSQTZINC IS NULL THEN NULL 
ELSE NULL 
 END as zinc_mg, 

CASE
        WHEN DSQTCOPP IS NOT NULL THEN DSQTCOPP 
WHEN DSQTCOPP IS NULL THEN NULL 
ELSE NULL 
 END as copper_mg, 

CASE
        WHEN DSQTSODI IS NOT NULL THEN DSQTSODI 
WHEN DSQTSODI IS NULL THEN NULL 
ELSE NULL 
 END as sodium_mg, 

CASE
        WHEN DSQTPOTA IS NOT NULL THEN DSQTPOTA 
WHEN DSQTPOTA IS NULL THEN NULL 
ELSE NULL 
 END as potassium_mg, 

CASE
        WHEN DSQTSELE IS NOT NULL THEN DSQTSELE 
WHEN DSQTSELE IS NULL THEN NULL 
ELSE NULL 
 END as selenium_mcg, 

CASE
        WHEN DSQTCAFF IS NOT NULL THEN DSQTCAFF 
WHEN DSQTCAFF IS NULL THEN NULL 
ELSE NULL 
 END as caffeine_mg, 

CASE
        WHEN DSQTIODI IS NOT NULL THEN SAFE_CAST(DSQTIODI AS FLOAT64) 
WHEN DSQTIODI IS NULL THEN NULL 
ELSE NULL 
 END as iodine_mcg, 

 FROM {{ ref('stg_dietary_supplement_use_30_day_total_dietary_supplements_dietary') }}