SELECT
SEQN as respondent_sequence_number, 

CASE
        WHEN WTDRD1 IS NOT NULL THEN WTDRD1 
WHEN WTDRD1 IS NOT NULL THEN WTDRD1 
WHEN WTDRD1 IS NULL THEN NULL 
ELSE NULL 
 END as dietary_day_one_sample_weight, 

CASE
        WHEN WTDR2D IS NOT NULL THEN WTDR2D 
WHEN WTDR2D IS NOT NULL THEN WTDR2D 
WHEN WTDR2D IS NULL THEN NULL 
ELSE NULL 
 END as dietary_two_day_sample_weight, 

CASE
        WHEN DR2DRSTZ = 1 THEN 'Reliable and met the minimum criteria' 
WHEN DR2DRSTZ = 2 THEN 'Not reliable or not met the minimum criteria' 
WHEN DR2DRSTZ = 4 THEN 'Reported consuming breast-milk' 
WHEN DR2DRSTZ = 5 THEN 'Not done' 
WHEN DR2DRSTZ IS NULL THEN NULL 
ELSE NULL 
 END as dietary_recall_status, 

CASE
        WHEN DR2EXMER IS NOT NULL THEN DR2EXMER 
WHEN DR2EXMER IS NULL THEN NULL 
ELSE NULL 
 END as interviewer_id_code, 

CASE
        WHEN DRDINT = 1 THEN 'Day 1 only' 
WHEN DRDINT = 2 THEN 'Day 1 and day 2' 
WHEN DRDINT IS NULL THEN NULL 
ELSE NULL 
 END as number_of_days_of_intake, 

CASE
        WHEN DR2DBIH IS NOT NULL THEN DR2DBIH 
WHEN DR2DBIH IS NULL THEN NULL 
ELSE NULL 
 END as of_days_b_w_intake_and_hh_interview, 

CASE
        WHEN DR2DAY = 1 THEN 'Sunday' 
WHEN DR2DAY = 2 THEN 'Monday' 
WHEN DR2DAY = 3 THEN 'Tuesday' 
WHEN DR2DAY = 4 THEN 'Wednesday' 
WHEN DR2DAY = 5 THEN 'Thursday' 
WHEN DR2DAY = 6 THEN 'Friday' 
WHEN DR2DAY = 7 THEN 'Saturday' 
WHEN DR2DAY IS NULL THEN NULL 
ELSE NULL 
 END as intake_day_of_the_week, 

CASE
        WHEN DR2LANG = 1 THEN 'English' 
WHEN DR2LANG = 2 THEN 'Spanish' 
WHEN DR2LANG = 3 THEN 'English and Spanish' 
WHEN DR2LANG = 4 THEN 'Other' 
WHEN DR2LANG = 5 THEN 'Asian Languages' 
WHEN DR2LANG = 6 THEN 'Asian Languages and English' 
WHEN DR2LANG IS NULL THEN NULL 
ELSE NULL 
 END as language_respondent_used_mostly, 

CASE
        WHEN DR2MRESP = '1' THEN 'SP' 
WHEN DR2MRESP = '2' THEN 'Mother of SP' 
WHEN DR2MRESP = '3' THEN 'Father of SP' 
WHEN DR2MRESP = '5' THEN 'Spouse of SP' 
WHEN DR2MRESP = '6' THEN 'Child of SP' 
WHEN DR2MRESP = '7' THEN 'Grandparent of SP' 
WHEN DR2MRESP = '8' THEN 'Friend, Partner, Non Relative' 
WHEN DR2MRESP = '9' THEN 'Translator, not a HH member' 
WHEN DR2MRESP = '10' THEN 'Child care provider, Caretaker' 
WHEN DR2MRESP = '11' THEN 'Other Relative' 
WHEN DR2MRESP = '77' THEN 'Refused' 
WHEN DR2MRESP = '99' THEN 'Dont know' 
WHEN DR2MRESP IS NULL THEN NULL 
ELSE NULL 
 END as main_respondent_for_this_interview, 

CASE
        WHEN DR2HELP = '1' THEN 'SP' 
WHEN DR2HELP = '4' THEN 'Parent of SP' 
WHEN DR2HELP = '5' THEN 'Spouse of SP' 
WHEN DR2HELP = '6' THEN 'Child of SP' 
WHEN DR2HELP = '7' THEN 'Grandparent of SP' 
WHEN DR2HELP = '8' THEN 'Friend, Partner, Non Relative' 
WHEN DR2HELP = '9' THEN 'Translator, not a HH member' 
WHEN DR2HELP = '10' THEN 'Child care provider, Caretaker' 
WHEN DR2HELP = '11' THEN 'Other Relative' 
WHEN DR2HELP = '12' THEN 'No One' 
WHEN DR2HELP = '77' THEN 'Refused' 
WHEN DR2HELP = '99' THEN 'Dont know' 
WHEN DR2HELP IS NULL THEN NULL 
ELSE NULL 
 END as helped_in_responding_for_this_interview, 

CASE
        WHEN DS2DSCNT IS NOT NULL THEN DS2DSCNT 
WHEN DS2DSCNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_dietary_supplements_taken, 

CASE
        WHEN DS2DS = 1 THEN 'Yes' 
WHEN DS2DS = 2 THEN 'No' 
WHEN DS2DS = 7 THEN 'Refused' 
WHEN DS2DS = 9 THEN 'Dont know' 
WHEN DS2DS IS NULL THEN NULL 
ELSE NULL 
 END as any_dietary_supplements_taken, 

CASE
        WHEN DS2ANCNT IS NOT NULL THEN DS2ANCNT 
WHEN DS2ANCNT IS NULL THEN NULL 
ELSE NULL 
 END as total_of_antacids_taken, 

CASE
        WHEN DS2AN = 1 THEN 'Yes' 
WHEN DS2AN = 2 THEN 'No' 
WHEN DS2AN = 7 THEN 'Refused' 
WHEN DS2AN = 9 THEN 'Dont know' 
WHEN DS2AN IS NULL THEN NULL 
ELSE NULL 
 END as any_antacids_taken, 

CASE
        WHEN DS2TKCAL IS NOT NULL THEN DS2TKCAL 
WHEN DS2TKCAL IS NULL THEN NULL 
ELSE NULL 
 END as energy_kcal, 

CASE
        WHEN DS2TPROT IS NOT NULL THEN DS2TPROT 
WHEN DS2TPROT IS NULL THEN NULL 
ELSE NULL 
 END as protein_gm, 

CASE
        WHEN DS2TCARB IS NOT NULL THEN DS2TCARB 
WHEN DS2TCARB IS NULL THEN NULL 
ELSE NULL 
 END as carbohydrate_gm, 

CASE
        WHEN DS2TSUGR IS NOT NULL THEN DS2TSUGR 
WHEN DS2TSUGR IS NULL THEN NULL 
ELSE NULL 
 END as total_sugars_gm, 

CASE
        WHEN DS2TFIBE IS NOT NULL THEN DS2TFIBE 
WHEN DS2TFIBE IS NULL THEN NULL 
ELSE NULL 
 END as dietary_fiber_gm, 

CASE
        WHEN DS2TTFAT IS NOT NULL THEN DS2TTFAT 
WHEN DS2TTFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_fat_gm, 

CASE
        WHEN DS2TSFAT IS NOT NULL THEN DS2TSFAT 
WHEN DS2TSFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_saturated_fatty_acids_gm, 

CASE
        WHEN DS2TMFAT IS NOT NULL THEN DS2TMFAT 
WHEN DS2TMFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_monounsaturated_fatty_acids_gm, 

CASE
        WHEN DS2TPFAT IS NOT NULL THEN DS2TPFAT 
WHEN DS2TPFAT IS NULL THEN NULL 
ELSE NULL 
 END as total_polyunsaturated_fatty_acids_gm, 

CASE
        WHEN DS2TCHOL IS NOT NULL THEN DS2TCHOL 
WHEN DS2TCHOL IS NULL THEN NULL 
ELSE NULL 
 END as cholesterol_mg, 

CASE
        WHEN DS2TLYCO IS NOT NULL THEN DS2TLYCO 
WHEN DS2TLYCO IS NULL THEN NULL 
ELSE NULL 
 END as lycopene_mcg, 

CASE
        WHEN DS2TLZ IS NOT NULL THEN DS2TLZ 
WHEN DS2TLZ IS NULL THEN NULL 
ELSE NULL 
 END as lutein_zeaxanthin_mcg, 

CASE
        WHEN DS2TVB1 IS NOT NULL THEN DS2TVB1 
WHEN DS2TVB1 IS NULL THEN NULL 
ELSE NULL 
 END as thiamin_vitamin_b1_mg, 

CASE
        WHEN DS2TVB2 IS NOT NULL THEN DS2TVB2 
WHEN DS2TVB2 IS NULL THEN NULL 
ELSE NULL 
 END as riboflavin_vitamin_b2_mg, 

CASE
        WHEN DS2TNIAC IS NOT NULL THEN DS2TNIAC 
WHEN DS2TNIAC IS NULL THEN NULL 
ELSE NULL 
 END as niacin_mg, 

CASE
        WHEN DS2TVB6 IS NOT NULL THEN DS2TVB6 
WHEN DS2TVB6 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b6_mg, 

CASE
        WHEN DS2TVB12 IS NOT NULL THEN DS2TVB12 
WHEN DS2TVB12 IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_b12_mcg, 

CASE
        WHEN DS2TFA IS NOT NULL THEN DS2TFA 
WHEN DS2TFA IS NULL THEN NULL 
ELSE NULL 
 END as folic_acid_mcg, 

CASE
        WHEN DS2TFDFE IS NOT NULL THEN DS2TFDFE 
WHEN DS2TFDFE IS NULL THEN NULL 
ELSE NULL 
 END as folate_dfe_mcg, 

CASE
        WHEN DS2TCHL IS NOT NULL THEN DS2TCHL 
WHEN DS2TCHL IS NULL THEN NULL 
ELSE NULL 
 END as total_choline_mg, 

CASE
        WHEN DS2TVC IS NOT NULL THEN DS2TVC 
WHEN DS2TVC IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_c_mg, 

CASE
        WHEN DS2TVK IS NOT NULL THEN DS2TVK 
WHEN DS2TVK IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_k_mcg, 

CASE
        WHEN DS2TVD IS NOT NULL THEN DS2TVD 
WHEN DS2TVD IS NULL THEN NULL 
ELSE NULL 
 END as vitamin_d_d2_d3_mcg, 

CASE
        WHEN DS2TCALC IS NOT NULL THEN DS2TCALC 
WHEN DS2TCALC IS NULL THEN NULL 
ELSE NULL 
 END as calcium_mg, 

CASE
        WHEN DS2TPHOS IS NOT NULL THEN DS2TPHOS 
WHEN DS2TPHOS IS NULL THEN NULL 
ELSE NULL 
 END as phosphorus_mg, 

CASE
        WHEN DS2TMAGN IS NOT NULL THEN DS2TMAGN 
WHEN DS2TMAGN IS NULL THEN NULL 
ELSE NULL 
 END as magnesium_mg, 

CASE
        WHEN DS2TIRON IS NOT NULL THEN DS2TIRON 
WHEN DS2TIRON IS NULL THEN NULL 
ELSE NULL 
 END as iron_mg, 

CASE
        WHEN DS2TZINC IS NOT NULL THEN DS2TZINC 
WHEN DS2TZINC IS NULL THEN NULL 
ELSE NULL 
 END as zinc_mg, 

CASE
        WHEN DS2TCOPP IS NOT NULL THEN DS2TCOPP 
WHEN DS2TCOPP IS NULL THEN NULL 
ELSE NULL 
 END as copper_mg, 

CASE
        WHEN DS2TSODI IS NOT NULL THEN DS2TSODI 
WHEN DS2TSODI IS NULL THEN NULL 
ELSE NULL 
 END as sodium_mg, 

CASE
        WHEN DS2TPOTA IS NOT NULL THEN DS2TPOTA 
WHEN DS2TPOTA IS NULL THEN NULL 
ELSE NULL 
 END as potassium_mg, 

CASE
        WHEN DS2TSELE IS NOT NULL THEN DS2TSELE 
WHEN DS2TSELE IS NULL THEN NULL 
ELSE NULL 
 END as selenium_mcg, 

CASE
        WHEN DS2TCAFF IS NOT NULL THEN DS2TCAFF 
WHEN DS2TCAFF IS NULL THEN NULL 
ELSE NULL 
 END as caffeine_mg, 

CASE
        WHEN DS2TIODI IS NOT NULL THEN SAFE_CAST(DS2TIODI AS FLOAT64) 
WHEN DS2TIODI IS NULL THEN NULL 
ELSE NULL 
 END as iodine_mcg, 

 FROM {{ ref('stg_dietary_supplement_use_24_hour_total_dietary_supplements_second_day_dietary') }}