SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN LBXALC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXALC AS FLOAT64) 
 END as alpha_carotene_ug_dl, 

CASE
WHEN LBDALCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDALCSI AS FLOAT64) 
 END as alpha_carotene_umol_l, 

CASE
WHEN LBXBEC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXBEC AS FLOAT64) 
 END as trans_beta_carotene_ug_dl, 

CASE
WHEN LBDBECSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDBECSI AS FLOAT64) 
 END as trans_beta_carotene_umol_l, 

CASE
WHEN LBXCBC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXCBC AS FLOAT64) 
 END as cis_beta_carotene_ug_dl, 

CASE
WHEN LBDCBCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDCBCSI AS FLOAT64) 
 END as cis_beta_carotene_umol_l, 

CASE
WHEN LBXCRY IS NULL THEN NULL 
ELSE SAFE_CAST(LBXCRY AS FLOAT64) 
 END as b_cryptoxanthin_ug_dl, 

CASE
WHEN LBDCRYSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDCRYSI AS FLOAT64) 
 END as b_cryptoxanthin_umol_l, 

CASE
WHEN LBXGTC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXGTC AS FLOAT64) 
 END as g_tocopherol_ug_dl, 

CASE
WHEN LBDGTCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDGTCSI AS FLOAT64) 
 END as g_tocopherol_umol_l, 

CASE
WHEN LBXLUZ IS NULL THEN NULL 
ELSE SAFE_CAST(LBXLUZ AS FLOAT64) 
 END as lutein_and_zeaxanthin_ug_dl, 

CASE
WHEN LBDLUZSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDLUZSI AS FLOAT64) 
 END as lutein_and_zeaxanthin_umol_l, 

CASE
WHEN LBXLYC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXLYC AS FLOAT64) 
 END as trans_lycopene_ug_dl, 

CASE
WHEN LBDLYCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDLYCSI AS FLOAT64) 
 END as trans_lycopene_umol_l, 

CASE
WHEN LBXRPL IS NULL THEN NULL 
ELSE SAFE_CAST(LBXRPL AS FLOAT64) 
 END as retinyl_palmitate_ug_dl, 

CASE
WHEN LBDRPLSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDRPLSI AS FLOAT64) 
 END as retinyl_palmitate_umol_l, 

CASE
WHEN LBXRST IS NULL THEN NULL 
ELSE SAFE_CAST(LBXRST AS FLOAT64) 
 END as retinyl_stearate_ug_dl, 

CASE
WHEN LBDRSTSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDRSTSI AS FLOAT64) 
 END as retinyl_stearate_umol_l, 

CASE
WHEN LBXVIA IS NULL THEN NULL 
ELSE SAFE_CAST(LBXVIA AS FLOAT64) 
 END as vitamin_a_ug_dl, 

CASE
WHEN LBDVIASI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDVIASI AS FLOAT64) 
 END as vitamin_a_umol_l, 

CASE
WHEN LBXVIE IS NULL THEN NULL 
ELSE SAFE_CAST(LBXVIE AS FLOAT64) 
 END as vitamin_e_ug_dl, 

CASE
WHEN LBDVIESI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDVIESI AS FLOAT64) 
 END as vitamin_e_umol_l, 

CASE
WHEN LBDTLY IS NOT NULL THEN SAFE_CAST(LBDTLY AS FLOAT64) -- correct wrong data types for numerical data 
WHEN LBDTLY IS NULL THEN NULL 
ELSE SAFE_CAST(LBDTLY AS FLOAT64) 
 END as total_cis_and_trans_lycopene_ug_dl, 

CASE
WHEN LBDTLYSI IS NOT NULL THEN SAFE_CAST(LBDTLYSI AS FLOAT64) -- correct wrong data types for numerical data 
WHEN LBDTLYSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDTLYSI AS FLOAT64) 
 END as total_cis_and_trans_lycopene_umol_l, 

CASE
WHEN LBXATC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXATC AS FLOAT64) 
 END as a_tocopherol_ug_dl, 

CASE
WHEN LBDATCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDATCSI AS FLOAT64) 
 END as a_tocopherol_umol_l, 

CASE
WHEN LBXACY IS NULL THEN NULL 
ELSE SAFE_CAST(LBXACY AS FLOAT64) 
 END as a_cryptoxanthin_ug_dl, 

CASE
WHEN LBDACYSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDACYSI AS FLOAT64) 
 END as a_cryptoxanthin_umol_l, 

CASE
WHEN LBXBCC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXBCC AS FLOAT64) 
 END as total_b_carotene_ug_dl, 

CASE
WHEN LBDBCCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDBCCSI AS FLOAT64) 
 END as total_b_carotene_umol_l, 

CASE
WHEN LBXCLC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXCLC AS FLOAT64) 
 END as cis_lycopene_ug_dl, 

CASE
WHEN LBDCLCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDCLCSI AS FLOAT64) 
 END as cis_lycopene_umol_l, 

CASE
WHEN LBXCLZ IS NULL THEN NULL 
ELSE SAFE_CAST(LBXCLZ AS FLOAT64) 
 END as cis_lutein_zeaxanthin_ug_dl, 

CASE
WHEN LBDCLZSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDCLZSI AS FLOAT64) 
 END as cis_lutein_zeaxanthin_umol_l, 

CASE
WHEN LBXDTC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXDTC AS FLOAT64) 
 END as d_tocopherol_ug_dl, 

CASE
WHEN LBDDTCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDDTCSI AS FLOAT64) 
 END as d_tocopherol_umol_l, 

CASE
WHEN LBXLCC IS NULL THEN NULL 
ELSE SAFE_CAST(LBXLCC AS FLOAT64) 
 END as total_lycopene_ug_dl, 

CASE
WHEN LBDLCCSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDLCCSI AS FLOAT64) 
 END as total_lycopene_umol_l, 

CASE
WHEN LBXLUT IS NULL THEN NULL 
ELSE SAFE_CAST(LBXLUT AS FLOAT64) 
 END as lutein_ug_dl, 

CASE
WHEN LBDLUTSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDLUTSI AS FLOAT64) 
 END as lutein_umol_l, 

CASE
WHEN LBXPHF IS NULL THEN NULL 
ELSE SAFE_CAST(LBXPHF AS FLOAT64) 
 END as phytofluene_ug_dl, 

CASE
WHEN LBDPHFSI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDPHFSI AS FLOAT64) 
 END as phytofluene_umol_l, 

CASE
WHEN LBXPHE IS NULL THEN NULL 
ELSE SAFE_CAST(LBXPHE AS FLOAT64) 
 END as phytoene_ug_dl, 

CASE
WHEN LBDPHESI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDPHESI AS FLOAT64) 
 END as phytoene_umol_l, 

CASE
WHEN LBXZEA IS NULL THEN NULL 
ELSE SAFE_CAST(LBXZEA AS FLOAT64) 
 END as zeaxanthin_ug_dl, 

CASE
WHEN LBDZEASI IS NULL THEN NULL 
ELSE SAFE_CAST(LBDZEASI AS FLOAT64) 
 END as zeaxanthin_umol_l, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_vitamin_a_vitamin_e_carotenoids_laboratory') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/VITAEC_D.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/L45VIT_C.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/L06VIT_B.htm
*/
