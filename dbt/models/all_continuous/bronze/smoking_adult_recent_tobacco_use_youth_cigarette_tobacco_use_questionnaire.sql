SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ620 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ620 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ620 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ620 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ620 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ620 AS STRING) 
 END as ever_tried_cigarette_smoking, 

CASE
WHEN SMD630 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD630 AS FLOAT64) 
 END as age_first_smoked_whole_cigarette, 

CASE
WHEN SMQ640 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ640 AS FLOAT64) 
 END as days_smoked_cigarettes_in_past_month, 

CASE
WHEN SMQ650 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ650 AS FLOAT64) 
 END as cigarettes_per_day_during_past_month, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Within 5 minutes,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'From 6 to 30 minutes,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'From more than 30 minutes to one hour, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'More than one hour?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ077 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ077 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ077 AS STRING) 
 END as how_soon_after_waking_do_you_smoke, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Marlboro' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Camel' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Newport' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Kool' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Winston' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Benson and Hedges' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Salem' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(8 AS FLOAT64),0) AS INT64) THEN 'Some other brand' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ660 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ660 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ660 AS STRING) 
 END as brands_of_cigarettes_smoked_past_mo, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ664B IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ664B AS STRING) 
 END as menthol_or_non_menthol_bensonhedges, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ664C IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ664C AS STRING) 
 END as menthol_or_non_menthol_camel, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ664M IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ664M AS STRING) 
 END as menthol_or_non_menthol_marlboro, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ664O IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ664O AS STRING) 
 END as menthol_or_non_menthol_other_brand, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-menthol' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ664W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ664W IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ664W AS STRING) 
 END as menthol_or_non_menthol_winston, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666B IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666B AS STRING) 
 END as regular_light_or_ultralite_bensonhedges, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666C IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666C AS STRING) 
 END as regular_light_or_ultralite_camel, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666K IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666K AS STRING) 
 END as regular_light_or_ultralite_kool, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666M IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666M AS STRING) 
 END as regular_light_or_ultralite_marlboro, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666N IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666N AS STRING) 
 END as regular_light_or_ultralite_newport, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regular' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Light' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666O AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666O IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666O AS STRING) 
 END as regular_light_or_ultralite_other_brand, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666S AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666S AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666S AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666S AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666S AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666S IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666S AS STRING) 
 END as regular_light_or_ultralite_salem, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Regulars' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Lights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ultralights' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ666W AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ666W IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ666W AS STRING) 
 END as regular_light_or_ultralite_winston, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ670 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ670 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ670 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ670 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ670 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ670 AS STRING) 
 END as tried_to_quit_smoking, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ680 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ680 AS STRING) 
 END as used_tobacco_nicotine_last_5_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Cigarettes' -- categorize numeric values
WHEN SMQ690A IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690A AS STRING) 
 END as used_last_5_days_cigarettes, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Pipes' -- categorize numeric values
WHEN SMQ690B IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690B AS STRING) 
 END as used_last_5_days_pipes, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Cigars' -- categorize numeric values
WHEN SMQ690C IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690C AS STRING) 
 END as used_last_5_days_cigars, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Chewing tobacco' -- categorize numeric values
WHEN SMQ690D IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690D AS STRING) 
 END as used_last_5_days_chewing_tobacco, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Snuff' -- categorize numeric values
WHEN SMQ690E IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690E AS STRING) 
 END as used_last_5_days_snuff, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ690F AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Nicotine patches, gum, or other nicotine product' -- categorize numeric values
WHEN SMQ690F IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ690F AS STRING) 
 END as used_last_5_days_patch_gum_other, 

CASE
WHEN SMQ710 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ710 AS FLOAT64) 
 END as days_smoked_cigarettes_last_5_days, 

CASE
WHEN SMQ720 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ720 AS FLOAT64) 
 END as cigarettes_smoked_per_day, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ725 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ725 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ725 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ725 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ725 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ725 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ725 AS STRING) 
 END as when_did_sp_smoke_last_cigarette, 

CASE
WHEN SMQ740 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ740 AS FLOAT64) 
 END as days_smoked_pipe_over_last_5_days, 

CASE
WHEN SMQ750 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ750 AS FLOAT64) 
 END as pipes_smoked_per_day_last_5_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ755 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ755 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ755 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ755 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ755 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ755 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ755 AS STRING) 
 END as when_did_sp_smoke_last_pipe, 

CASE
WHEN SMQ770 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ770 AS FLOAT64) 
 END as days_smoked_cigars_over_last_5_days, 

CASE
WHEN SMQ780 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ780 AS FLOAT64) 
 END as cigars_smoked_per_day_last_5_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ785 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ785 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ785 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ785 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ785 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ785 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ785 AS STRING) 
 END as when_did_sp_smoke_last_cigar, 

CASE
WHEN SMQ800 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ800 AS FLOAT64) 
 END as days_used_chewing_tobacco_last_5_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ815 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ815 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ815 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ815 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ815 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ815 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ815 AS STRING) 
 END as when_did_sp_last_use_chewing_tobacco, 

CASE
WHEN SMQ817 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ817 AS FLOAT64) 
 END as days_used_snuff_over_last_5_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ819 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ819 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ819 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ819 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ819 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ819 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ819 AS STRING) 
 END as when_last_used_snuff, 

CASE
WHEN SMQ830 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ830 AS FLOAT64) 
 END as days_used_nicotine_stop_smoking_aids, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ840 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Today' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ840 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yesterday' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ840 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days ago' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ840 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMQ840 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMQ840 IS NULL THEN NULL 
ELSE SAFE_CAST(SMQ840 AS STRING) 
 END as last_time_used_nicotine_stop_smoking_aid, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMAQUEX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A-CASI B(12 Yrs.-19 Yrs.)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMAQUEX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MEC CAPI B(20 Yrs.-150 Yrs.)' -- categorize numeric values
WHEN SMAQUEX IS NULL THEN NULL 
ELSE SAFE_CAST(SMAQUEX AS STRING) 
 END as questionnaire_mode_flag, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD680 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMD680 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD680 AS STRING) 
 END as used_tobacco_nicotine_last_5_days_SMD680, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Cigarettes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SMD690A IS NULL THEN NULL 
ELSE SAFE_CAST(SMD690A AS STRING) 
 END as used_last_5_days_cigarettes_SMD690A, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Pipes' -- categorize numeric values
WHEN SMD690B IS NULL THEN NULL 
ELSE SAFE_CAST(SMD690B AS STRING) 
 END as used_last_5_days_pipes_SMD690B, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Cigars' -- categorize numeric values
WHEN SMD690C IS NULL THEN NULL 
ELSE SAFE_CAST(SMD690C AS STRING) 
 END as used_last_5_days_cigars_SMD690C, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Chewing tobacco' -- categorize numeric values
WHEN SMD690D IS NULL THEN NULL 
ELSE SAFE_CAST(SMD690D AS STRING) 
 END as used_last_5_days_chewing_tobacco_SMD690D, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(SMD690F AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Nicotine patches, gum, or other nicotine product' -- categorize numeric values
WHEN SMD690F IS NULL THEN NULL 
ELSE SAFE_CAST(SMD690F AS STRING) 
 END as used_last_5_days_patch_gum_other_SMD690F, 

CASE
WHEN SMD710 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD710 AS FLOAT64) 
 END as days_smoked_cigarettes_last_5_days_SMD710, 

CASE
WHEN SMD720 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD720 AS FLOAT64) 
 END as cigarettes_smoked_day_last_5_days, 

CASE
WHEN SMD740 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD740 AS FLOAT64) 
 END as days_smoked_pipe_last_5_days, 

CASE
WHEN SMD750 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD750 AS FLOAT64) 
 END as pipes_smoked_per_day_last_5_days_SMD750, 

CASE
WHEN SMD770 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD770 AS FLOAT64) 
 END as days_smoked_cigars_last_5_days, 

CASE
WHEN SMD780 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD780 AS FLOAT64) 
 END as cigars_smoked_day_last_5_days, 

CASE
WHEN SMD800 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD800 AS FLOAT64) 
 END as days_used_chewing_tobacco_last_5_days_SMD800, 

CASE
WHEN SMD830 IS NULL THEN NULL 
ELSE SAFE_CAST(SMD830 AS FLOAT64) 
 END as days_used_nicotine_aids_last_5_days, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_smoking_adult_recent_tobacco_use_youth_cigarette_tobacco_use_questionnaire') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/SMQMEC_C.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/SMQMEC_B.htm
https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/SMQMEC.htm
*/
