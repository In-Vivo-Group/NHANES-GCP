SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXDLSPST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'IVA Lateral Spine scan completed, all vertebra are valid' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXDLSPST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'IVA Lateral Spine scan completed, but one or more vertebrae are invalid' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXDLSPST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'IVA Lateral Spine not scanned, pregnancy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXDLSPST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'IVA Lateral Spine not scanned, weight > 450 lbs' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXDLSPST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'IVA Lateral Spine not scanned, other reason' -- categorize numeric values
WHEN DXDLSPST IS NULL THEN NULL 
ELSE SAFE_CAST(DXDLSPST AS STRING) 
 END as iva_lateral_spine_scan_status, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT4CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT4CC AS STRING) 
 END as t4_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT5CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT5CC AS STRING) 
 END as t5_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT6CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT6CC AS STRING) 
 END as t6_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT7CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT7CC AS STRING) 
 END as t7_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT8CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT8CC AS STRING) 
 END as t8_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT9CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT9CC AS STRING) 
 END as t9_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT10CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT10CC AS STRING) 
 END as t10_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT11CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT11CC AS STRING) 
 END as t11_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXT12CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT12CC AS STRING) 
 END as t12_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXL1CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL1CC AS STRING) 
 END as l1_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXL2CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL2CC AS STRING) 
 END as l2_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXL3CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL3CC AS STRING) 
 END as l3_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Valid data' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Removable or non-removable objects' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Excessive x-ray noise due to morbid obesity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Insufficient scan area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Movement' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4CC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Other (degenerative diseases, spinal fusion, fractures)' -- categorize numeric values
WHEN DXXL4CC IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL4CC AS STRING) 
 END as l4_fracture_invalidity_code, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXVFAST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Normal (No fracture in T4-L4 and there are no more than one un-evaluable vertebrae in T7 to L4)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXVFAST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Fractured (Mild, moderate or severe fracture at any level inT4-L4)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXVFAST AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Un-interpretable (No fracture and more than one un-evaluable vertebrae in T7-L4)' -- categorize numeric values
WHEN DXXVFAST IS NULL THEN NULL 
ELSE SAFE_CAST(DXXVFAST AS STRING) 
 END as vertebral_fracture_status_summary, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT4FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT4FX AS STRING) 
 END as t4_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT5FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT5FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT5FX AS STRING) 
 END as t5_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT6FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT6FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT6FX AS STRING) 
 END as t6_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT7FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT7FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT7FX AS STRING) 
 END as t7_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT8FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT8FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT8FX AS STRING) 
 END as t8_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT9FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT9FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT9FX AS STRING) 
 END as t9_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT10FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT10FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT10FX AS STRING) 
 END as t10_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT11FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT11FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT11FX AS STRING) 
 END as t11_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXT12FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXT12FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXT12FX AS STRING) 
 END as t12_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL1FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXL1FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL1FX AS STRING) 
 END as l1_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL2FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXL2FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL2FX AS STRING) 
 END as l2_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL3FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXL3FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL3FX AS STRING) 
 END as l3_fracture_score, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Normal (Grade 0)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Mild deformity (Grade 1)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Moderate deformity (Grade 2)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(DXXL4FX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Severe deformity (Grade 3)' -- categorize numeric values
WHEN DXXL4FX IS NULL THEN NULL 
ELSE SAFE_CAST(DXXL4FX AS STRING) 
 END as l4_fracture_score, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_dual_energy_x_ray_absorptiometry_vertebral_fracture_assessment_examination') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DXXVFA_H.htm
*/
