SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'AEROBICS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'BASEBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'BASKETBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'BICYCLING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'BOWLING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'DANCE' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'FISHING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(17 AS FLOAT64),0) AS INT64) THEN 'FOOTBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(18 AS FLOAT64),0) AS INT64) THEN 'GARDENING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(19 AS FLOAT64),0) AS INT64) THEN 'GOLF' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'HIKING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(21 AS FLOAT64),0) AS INT64) THEN 'HOCKEY' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(22 AS FLOAT64),0) AS INT64) THEN 'HUNTING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(23 AS FLOAT64),0) AS INT64) THEN 'JOGGING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(24 AS FLOAT64),0) AS INT64) THEN 'KAYAKING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(25 AS FLOAT64),0) AS INT64) THEN 'PUSH-UPS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(26 AS FLOAT64),0) AS INT64) THEN 'RACQUETBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(27 AS FLOAT64),0) AS INT64) THEN 'ROLLERBLADING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(28 AS FLOAT64),0) AS INT64) THEN 'ROWING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(29 AS FLOAT64),0) AS INT64) THEN 'RUNNING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(30 AS FLOAT64),0) AS INT64) THEN 'SIT-UPS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(31 AS FLOAT64),0) AS INT64) THEN 'SKATING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(32 AS FLOAT64),0) AS INT64) THEN 'SKIING - CROSS COUNTRY' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(33 AS FLOAT64),0) AS INT64) THEN 'SKIING - DOWNHILL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(34 AS FLOAT64),0) AS INT64) THEN 'SOCCER' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(35 AS FLOAT64),0) AS INT64) THEN 'SOFTBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(36 AS FLOAT64),0) AS INT64) THEN 'STAIR CLIMBING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(37 AS FLOAT64),0) AS INT64) THEN 'STRETCHING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(38 AS FLOAT64),0) AS INT64) THEN 'SWIMMING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(39 AS FLOAT64),0) AS INT64) THEN 'TENNIS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(40 AS FLOAT64),0) AS INT64) THEN 'TREADMILL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(41 AS FLOAT64),0) AS INT64) THEN 'VOLLEYBALL' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(42 AS FLOAT64),0) AS INT64) THEN 'WALKING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(43 AS FLOAT64),0) AS INT64) THEN 'WEIGHT LIFTING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(44 AS FLOAT64),0) AS INT64) THEN 'YARD WORK' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(50 AS FLOAT64),0) AS INT64) THEN 'BOXING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(51 AS FLOAT64),0) AS INT64) THEN 'FRISBEE' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(52 AS FLOAT64),0) AS INT64) THEN 'HORSEBACK RIDING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(53 AS FLOAT64),0) AS INT64) THEN 'MARTIAL ARTS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(54 AS FLOAT64),0) AS INT64) THEN 'WRESTLING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(55 AS FLOAT64),0) AS INT64) THEN 'YOGA' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(56 AS FLOAT64),0) AS INT64) THEN 'CHEERLEADING AND GYMNASTICS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(57 AS FLOAT64),0) AS INT64) THEN 'CHILDRENS GAMES (E.G. DODGEBALL, KICKBALL)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(58 AS FLOAT64),0) AS INT64) THEN 'ROPE JUMPING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(59 AS FLOAT64),0) AS INT64) THEN 'SKATEBOARDING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(60 AS FLOAT64),0) AS INT64) THEN 'SURFING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(61 AS FLOAT64),0) AS INT64) THEN 'TRAMPOLINE JUMPING' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADACTIV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(71 AS FLOAT64),0) AS INT64) THEN 'OTHER' -- categorize numeric values
WHEN PADACTIV IS NULL THEN NULL 
ELSE SAFE_CAST(PADACTIV AS STRING) 
 END as leisure_time_activity, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADLEVEL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'MODERATE' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PADLEVEL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'VIGOROUS' -- categorize numeric values
WHEN PADLEVEL IS NULL THEN NULL 
ELSE SAFE_CAST(PADLEVEL AS STRING) 
 END as activity_level, 

CASE
WHEN PADTIMES IS NULL THEN NULL 
ELSE SAFE_CAST(PADTIMES AS FLOAT64) 
 END as of_times_did_activity_in_past_30_days, 

CASE
WHEN PADDURAT IS NULL THEN NULL 
ELSE SAFE_CAST(PADDURAT AS FLOAT64) 
 END as average_duration_of_activity_minutes, 

CASE
WHEN PADMETS IS NULL THEN NULL 
ELSE SAFE_CAST(PADMETS AS FLOAT64) 
 END as met_score_for_activity, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(PAAQUEX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Sample Person Interview Questionnaire Targets (B(16-150))' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(PAAQUEX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MEC CAPI Questionnaire Targets (B(12-15))' -- categorize numeric values
WHEN PAAQUEX IS NULL THEN NULL 
ELSE SAFE_CAST(PAAQUEX AS STRING) 
 END as questionnaire_source_flag_for_weighting, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_physical_activity_individual_activities_questionnaire') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/PAQIAF_D.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/PAQIAF_C.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/PAQIAF_B.htm
https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/PAQIAF.htm
*/
