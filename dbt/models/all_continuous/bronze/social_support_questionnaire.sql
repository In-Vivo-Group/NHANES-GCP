SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'SP doesnt need help' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ011 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ011 AS STRING) 
 END as anyone_to_help_with_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'Spouse' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ021A IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021A AS STRING) 
 END as spouse_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'Daughter' -- categorize numeric values
WHEN SSQ021B IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021B AS STRING) 
 END as daughter_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Son' -- categorize numeric values
WHEN SSQ021C IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021C AS STRING) 
 END as son_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Sister/brother' -- categorize numeric values
WHEN SSQ021D IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021D AS STRING) 
 END as sibling_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'Parent' -- categorize numeric values
WHEN SSQ021E IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021E AS STRING) 
 END as parent_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021F AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'Other relative' -- categorize numeric values
WHEN SSQ021F IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021F AS STRING) 
 END as other_relative_gives_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021G AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'Neighbors' -- categorize numeric values
WHEN SSQ021G IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021G AS STRING) 
 END as neighbors_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021H AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(17 AS FLOAT64),0) AS INT64) THEN 'Co-workers' -- categorize numeric values
WHEN SSQ021H IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021H AS STRING) 
 END as co_workers_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021I AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(18 AS FLOAT64),0) AS INT64) THEN 'Church members' -- categorize numeric values
WHEN SSQ021I IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021I AS STRING) 
 END as church_members_give_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021J AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(19 AS FLOAT64),0) AS INT64) THEN 'Club members' -- categorize numeric values
WHEN SSQ021J IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021J AS STRING) 
 END as club_members_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'Professionals' -- categorize numeric values
WHEN SSQ021K IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021K AS STRING) 
 END as professionls_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021L AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(21 AS FLOAT64),0) AS INT64) THEN 'Friends' -- categorize numeric values
WHEN SSQ021L IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021L AS STRING) 
 END as friends_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(22 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN SSQ021M IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021M AS STRING) 
 END as others_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ021N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(23 AS FLOAT64),0) AS INT64) THEN 'No one' -- categorize numeric values
WHEN SSQ021N IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ021N AS STRING) 
 END as no_one_gives_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ031 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ031 AS STRING) 
 END as needed_more_support_in_past_year, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A lot more emotional support' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some emotional support' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'A little more emotional support' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ041 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ041 AS STRING) 
 END as how_much_more_support_needed, 

CASE
    WHEN SSD044 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD044 AS FLOAT64) 
 END as how_often_attend_church_per_year, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Offered help but wouldnt accept it' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ051 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ051 AS STRING) 
 END as anyone_to_help_with_financial_support, 

CASE
    WHEN SSQ061 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ061 AS FLOAT64) 
 END as number_of_close_friends, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'SP doesnt need help' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD011 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSD011 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD011 AS STRING) 
 END as anyone_to_help_with_emotional_support_SSD011, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'Spouse' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSD021A IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021A AS STRING) 
 END as spouse_gives_most_emotional_support_SSD021A, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'Daughter' -- categorize numeric values
WHEN SSD021B IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021B AS STRING) 
 END as daughter_gives_most_emotional_support_SSD021B, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Son' -- categorize numeric values
WHEN SSD021C IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021C AS STRING) 
 END as son_gives_most_emotional_support_SSD021C, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Sister/brother' -- categorize numeric values
WHEN SSD021D IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021D AS STRING) 
 END as sibling_gives_most_emotional_support_SSD021D, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'Parent' -- categorize numeric values
WHEN SSD021E IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021E AS STRING) 
 END as parent_gives_most_emotional_support_SSD021E, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021F AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'Other relative' -- categorize numeric values
WHEN SSD021F IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021F AS STRING) 
 END as other_relative_gives_emotional_support_SSD021F, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021G AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'Neighbors' -- categorize numeric values
WHEN SSD021G IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021G AS STRING) 
 END as neighbors_give_most_emotional_support_SSD021G, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021H AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(17 AS FLOAT64),0) AS INT64) THEN 'Co-workers' -- categorize numeric values
WHEN SSD021H IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021H AS STRING) 
 END as co_workers_give_most_emotional_support_SSD021H, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021I AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(18 AS FLOAT64),0) AS INT64) THEN 'Church members' -- categorize numeric values
WHEN SSD021I IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021I AS STRING) 
 END as church_members_give_emotional_support_SSD021I, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021J AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(19 AS FLOAT64),0) AS INT64) THEN 'Club members' -- categorize numeric values
WHEN SSD021J IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021J AS STRING) 
 END as club_members_give_most_emotional_support_SSD021J, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'Professionals' -- categorize numeric values
WHEN SSD021K IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021K AS STRING) 
 END as professionl_give_most_emotional_support, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021L AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(21 AS FLOAT64),0) AS INT64) THEN 'Friends' -- categorize numeric values
WHEN SSD021L IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021L AS STRING) 
 END as friends_give_most_emotional_support_SSD021L, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(22 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN SSD021M IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021M AS STRING) 
 END as others_give_most_emotional_support_SSD021M, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD021N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(23 AS FLOAT64),0) AS INT64) THEN 'No one' -- categorize numeric values
WHEN SSD021N IS NULL THEN NULL 
ELSE SAFE_CAST(SSD021N AS STRING) 
 END as no_one_gives_most_emotional_support_SSD021N, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSD031 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD031 AS STRING) 
 END as needed_more_support_in_past_year_SSD031, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A lot more,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'A little more emotional support?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSD041 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD041 AS STRING) 
 END as how_much_more_support_needed_SSD041, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Offered help but wouldnt accept it' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSD051 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSD051 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD051 AS STRING) 
 END as anyone_to_help_with_financial_support_SSD051, 

CASE
    WHEN SSD061 IS NULL THEN NULL 
ELSE SAFE_CAST(SSD061 AS FLOAT64) 
 END as number_of_close_friends_SSD061, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'SP doesnt need help' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ010 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ010 AS STRING) 
 END as anyone_to_help_with_emotional_support_SSQ010, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'Spouse' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ020A IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020A AS STRING) 
 END as spouse_gives_most_emotional_support_SSQ020A, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'Daughter' -- categorize numeric values
WHEN SSQ020B IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020B AS STRING) 
 END as daughter_gives_most_emotional_support_SSQ020B, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Son' -- categorize numeric values
WHEN SSQ020C IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020C AS STRING) 
 END as son_gives_most_emotional_support_SSQ020C, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Sister/brother' -- categorize numeric values
WHEN SSQ020D IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020D AS STRING) 
 END as sibling_gives_most_emotional_support_SSQ020D, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'Parent' -- categorize numeric values
WHEN SSQ020E IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020E AS STRING) 
 END as parent_gives_most_emotional_support_SSQ020E, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020F AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'Other relative' -- categorize numeric values
WHEN SSQ020F IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020F AS STRING) 
 END as other_relative_gives_emotional_support_SSQ020F, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020G AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'Neighbors' -- categorize numeric values
WHEN SSQ020G IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020G AS STRING) 
 END as neighbors_give_most_emotional_support_SSQ020G, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020H AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(17 AS FLOAT64),0) AS INT64) THEN 'Co-workers' -- categorize numeric values
WHEN SSQ020H IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020H AS STRING) 
 END as co_workers_give_most_emotional_support_SSQ020H, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020I AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(18 AS FLOAT64),0) AS INT64) THEN 'Church members' -- categorize numeric values
WHEN SSQ020I IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020I AS STRING) 
 END as church_members_give_emotional_support_SSQ020I, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020J AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(19 AS FLOAT64),0) AS INT64) THEN 'Club members' -- categorize numeric values
WHEN SSQ020J IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020J AS STRING) 
 END as club_members_give_most_emotional_support_SSQ020J, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020K AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'Professionals' -- categorize numeric values
WHEN SSQ020K IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020K AS STRING) 
 END as professionls_give_most_emotional_support_SSQ020K, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020L AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(21 AS FLOAT64),0) AS INT64) THEN 'Friends' -- categorize numeric values
WHEN SSQ020L IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020L AS STRING) 
 END as friends_give_most_emotional_support_SSQ020L, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020M AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(22 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN SSQ020M IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020M AS STRING) 
 END as others_give_most_emotional_support_SSQ020M, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ020N AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(23 AS FLOAT64),0) AS INT64) THEN 'No one' -- categorize numeric values
WHEN SSQ020N IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ020N AS STRING) 
 END as no_one_gives_most_emotional_support_SSQ020N, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ030 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ030 AS STRING) 
 END as needed_more_support_in_past_year_SSQ030, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A lot more,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'A little more emotional support?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ040 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ040 AS STRING) 
 END as how_much_more_support_needed_SSQ040, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ050 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ050 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ050 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Offered help but wouldnt accept it' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ050 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(SSQ050 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN SSQ050 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ050 AS STRING) 
 END as anyone_to_help_with_financial_support_SSQ050, 

CASE
    WHEN SSQ060 IS NULL THEN NULL 
ELSE SAFE_CAST(SSQ060 AS FLOAT64) 
 END as number_of_close_friends_SSQ060, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_social_support_questionnaire') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSQ_E.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/SSQ_D.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/SSQ_C.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/SSQ_B.htm
https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/SSQ.htm
*/
