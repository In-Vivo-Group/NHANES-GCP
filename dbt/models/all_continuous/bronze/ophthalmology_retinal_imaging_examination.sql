SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCST2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Complete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCST2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Partial' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCST2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Not done' -- categorize numeric values
WHEN OPASCST2 IS NULL THEN NULL 
ELSE SAFE_CAST(OPASCST2 AS STRING) 
 END as exam_status, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Safety exclusion' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'SP refusal' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'No time' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Physical limitation' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Communication problem' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Equipment failure' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'SP ill/emergency' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Eye specific limitation' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'Interrupted' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(56 AS FLOAT64),0) AS INT64) THEN 'Came late/left early' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(72 AS FLOAT64),0) AS INT64) THEN 'Error (technician/software/supply)' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(84 AS FLOAT64),0) AS INT64) THEN 'SP with child' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(86 AS FLOAT64),0) AS INT64) THEN 'SP Blind' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Other, specify' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(101 AS FLOAT64),0) AS INT64) THEN 'Eye specific limitation: Small pupil size' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(103 AS FLOAT64),0) AS INT64) THEN 'Eye specific limitation: SP unable to keep eyes open' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPASCCT2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(104 AS FLOAT64),0) AS INT64) THEN 'Eye specific limitation: SP unable to fixate adequately' -- categorize numeric values
WHEN OPASCCT2 IS NULL THEN NULL 
ELSE SAFE_CAST(OPASCCT2 AS STRING) 
 END as reason_for_not_done_partial, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ110 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ110 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN VIQ110 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ110 AS STRING) 
 END as sp_has_severe_eye_infection, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ121 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Right' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ121 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Left' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ121 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN VIQ121 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ121 AS STRING) 
 END as if_so_which_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ130 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ130 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN VIQ130 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ130 AS STRING) 
 END as sp_wearing_eye_patch, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No photos' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Incomplete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Complete' -- categorize numeric values
WHEN OPXDCOMP IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDCOMP AS STRING) 
 END as are_field_1_field_2_present_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF1 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Absent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF1 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present' -- categorize numeric values
WHEN OPXDF1 IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDF1 AS STRING) 
 END as field_1_present_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Good/fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Borderline' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN OPXDF1FO IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDF1FO AS STRING) 
 END as field_1_focus_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Absent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present' -- categorize numeric values
WHEN OPXDF2 IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDF2 AS STRING) 
 END as field_2_present_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Good/fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Borderline' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN OPXDF2FO IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDF2FO AS STRING) 
 END as field_2_focus_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Gradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Disc ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Part macula' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Macula ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Part disc & macula' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Disc & macula ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXDGRBL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDGRBL AS STRING) 
 END as gradability_of_images_right_eye, 

CASE
WHEN OPXDPMM IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPMM AS FLOAT64) 
 END as pupil_size_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHPR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHPR AS STRING) 
 END as photo_problems_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHIL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHIL AS STRING) 
 END as photo_prob_illumination_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHFD IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHFD AS STRING) 
 END as photo_prob_field_definition_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHHZ IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHHZ AS STRING) 
 END as photo_prob_haze_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHDD IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHDD AS STRING) 
 END as photo_prob_dust_dirt_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHLA IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHLA AS STRING) 
 END as photo_prob_lashes_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHAR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHAR AS STRING) 
 END as photo_prob_arc_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHRC IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHRC AS STRING) 
 END as photo_prob_red_channel_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXDPHOT IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDPHOT AS STRING) 
 END as photo_prob_other_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Non-diabetic retinal disease specific retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Questionable retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'HE, SE, IRMA, VL but no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'HEM only, no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(31 AS FLOAT64),0) AS INT64) THEN 'Early NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(41 AS FLOAT64),0) AS INT64) THEN 'Moderate NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(51 AS FLOAT64),0) AS INT64) THEN 'Severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(60 AS FLOAT64),0) AS INT64) THEN 'Fibrous prolif. only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(61 AS FLOAT64),0) AS INT64) THEN 'No retinopathy but PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(62 AS FLOAT64),0) AS INT64) THEN 'MAS only + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(63 AS FLOAT64),0) AS INT64) THEN 'Early NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(64 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(65 AS FLOAT64),0) AS INT64) THEN 'PR < HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(70 AS FLOAT64),0) AS INT64) THEN 'PR >= HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(80 AS FLOAT64),0) AS INT64) THEN 'Total VH' -- categorize numeric values
WHEN OPDURET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDURET AS STRING) 
 END as retinopathy_level_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Mild NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'PR (Proliferative)' -- categorize numeric values
WHEN OPDURL4 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDURL4 AS STRING) 
 END as exa_4_levels_retinopathy_severity_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUARMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUARMA AS STRING) 
 END as any_retinopathy_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'HEM only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS < 2A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS >= 2A' -- categorize numeric values
WHEN OPDUHMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUHMA AS STRING) 
 END as mas_hem_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUMA AS STRING) 
 END as retinal_microaneurysms_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUHEM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUHEM AS STRING) 
 END as retinal_blot_hemorrhages_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUHE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUHE AS STRING) 
 END as retinal_hard_exudate_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSE AS STRING) 
 END as retinal_soft_exudate_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 8A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 8A' -- categorize numeric values
WHEN OPDUIRMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUIRMA AS STRING) 
 END as irma_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUVB IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUVB AS STRING) 
 END as retinal_venous_beading_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 10A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 10A' -- categorize numeric values
WHEN OPDUNVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUNVO AS STRING) 
 END as retinal_new_vessels_on_disc_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1/2 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1/2 Disc Area' -- categorize numeric values
WHEN OPDUNVE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUNVE AS STRING) 
 END as retinal_new_vessels_elsewhere_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'FPD only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'FPE only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'FPD + FPE' -- categorize numeric values
WHEN OPDURFP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDURFP AS STRING) 
 END as retinal_fibrous_proliferation_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1 Disc Area' -- categorize numeric values
WHEN OPDUPHVH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPHVH AS STRING) 
 END as pre_ret_vitreous_hemorrhage_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes, but not CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDUME IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUME AS STRING) 
 END as macular_edema_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present and CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'CSME with cysts' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDUMEC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUMEC AS STRING) 
 END as macular_edema_in_center_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable/incomplete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Local' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Scatter only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Scatter + local' -- categorize numeric values
WHEN OPDUPPS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPPS AS STRING) 
 END as panret_photocoagulation_scar_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MA RX only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Grid only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'MA RX & Grid RX' -- categorize numeric values
WHEN OPDUFOC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUFOC AS STRING) 
 END as focal_photocoag_scars_for_me_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Early ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Late ARM' -- categorize numeric values
WHEN OPDUARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUARM AS STRING) 
 END as arm_3_severity_levels_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUPIGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPIGA AS STRING) 
 END as ret_pigmentary_abnorm_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDULARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDULARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDULARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDULARM AS STRING) 
 END as late_arm_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUGA AS STRING) 
 END as geographic_atrophy_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUEXU IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUEXU AS STRING) 
 END as exudative_arm_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUHD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUHD AS STRING) 
 END as hard_distinct_drusen_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUD125 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUD125 AS STRING) 
 END as drusen_125_microns_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUD500 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUD500 AS STRING) 
 END as drusen_500_microns_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUASD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUASD AS STRING) 
 END as any_soft_drusen_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSDD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSDD AS STRING) 
 END as soft_distinct_drusen_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSID IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSID AS STRING) 
 END as soft_indistinct_drusen_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUIRP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUIRP AS STRING) 
 END as increased_retinal_pigment_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDURPE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDURPE AS STRING) 
 END as rpe_depigmentation_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUAGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUAGA AS STRING) 
 END as any_geographic_atrophy_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUPED IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPED AS STRING) 
 END as rpe_sensory_ret_detachment_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSNV IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSNV AS STRING) 
 END as subretinal_new_vessels_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSUBH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSUBH AS STRING) 
 END as subretinal_hemorrhage_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUSFS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSFS AS STRING) 
 END as subretinal_fibrous_scar_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUARMX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUARMX AS STRING) 
 END as treatment_for_arm_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUBCO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUBCO AS STRING) 
 END as retinal_artery_occlusion_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUBVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUBVO AS STRING) 
 END as retinal_branch_vein_occlusion_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUCVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUCVO AS STRING) 
 END as ret_central_vein_occlusion_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUAVN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUAVN AS STRING) 
 END as retinal_av_nicking_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUFAN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUFAN AS STRING) 
 END as focal_arteriolar_narrowing_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUHOLL IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUHOLL AS STRING) 
 END as hollenhorst_plaque_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUPPA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPPA AS STRING) 
 END as peripapillary_atrophy_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUASHY IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUASHY AS STRING) 
 END as asteroid_hyalosis_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUCHRA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUCHRA AS STRING) 
 END as chorioretinal_abnormality_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDUMACH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUMACH AS STRING) 
 END as macular_hole_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUCHN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUCHN AS STRING) 
 END as choroidal_nevus_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUOTRX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUOTRX AS STRING) 
 END as any_other_treatment_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUPOHS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUPOHS AS STRING) 
 END as histoplasmosis_syndrome_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDURDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDURDET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDURDET AS STRING) 
 END as retinal_detachment_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUSWR IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSWR AS STRING) 
 END as sw_cellophane_changes_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUSWRT IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUSWRT AS STRING) 
 END as sw_traction_changes_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDUOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDUOTHC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDUOTHC AS STRING) 
 END as other_ocular_conditions_worse_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Non-diabetic retinal disease specific retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Questionable retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'HE, SE, IRMA, VL but no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'HEM only, no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(31 AS FLOAT64),0) AS INT64) THEN 'Early NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(41 AS FLOAT64),0) AS INT64) THEN 'Moderate NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(51 AS FLOAT64),0) AS INT64) THEN 'Severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(60 AS FLOAT64),0) AS INT64) THEN 'Fibrous prolif. only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(61 AS FLOAT64),0) AS INT64) THEN 'No retinopathy but PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(62 AS FLOAT64),0) AS INT64) THEN 'MAS only + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(63 AS FLOAT64),0) AS INT64) THEN 'Early NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(64 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(65 AS FLOAT64),0) AS INT64) THEN 'PR < HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(70 AS FLOAT64),0) AS INT64) THEN 'PR >= HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(80 AS FLOAT64),0) AS INT64) THEN 'Total VH' -- categorize numeric values
WHEN OPDDRET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDRET AS STRING) 
 END as retinopathy_level_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Mild NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'PR (Proliferative)' -- categorize numeric values
WHEN OPDDRL4 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDRL4 AS STRING) 
 END as exa_4_levels_retinopathy_severity_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDARMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDARMA AS STRING) 
 END as any_retinopathy_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'HEM only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS < 2A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS >= 2A' -- categorize numeric values
WHEN OPDDHMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDHMA AS STRING) 
 END as mas_hem_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDMA AS STRING) 
 END as retinal_microaneurysms_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDHEM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDHEM AS STRING) 
 END as retinal_blot_hemorrhages_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDHE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDHE AS STRING) 
 END as retinal_hard_exudate_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSE AS STRING) 
 END as retinal_soft_exudate_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 8A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 8A' -- categorize numeric values
WHEN OPDDIRMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDIRMA AS STRING) 
 END as irma_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDVB IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDVB AS STRING) 
 END as retinal_venous_beading_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 10A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 10A' -- categorize numeric values
WHEN OPDDNVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDNVO AS STRING) 
 END as retinal_new_vessels_on_disc_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1/2 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1/2 Disc Area' -- categorize numeric values
WHEN OPDDNVE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDNVE AS STRING) 
 END as retinal_new_vessels_elsewhere_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'FPD only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'FPE only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'FPD + FPE' -- categorize numeric values
WHEN OPDDRFP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDRFP AS STRING) 
 END as retinal_fibrous_proliferation_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1 Disc Area' -- categorize numeric values
WHEN OPDDPHVH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPHVH AS STRING) 
 END as pre_ret_vitreous_hemorrhage_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes, but not CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDDME IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDME AS STRING) 
 END as macular_edema_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present and CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'CSME with cysts' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDDMEC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDMEC AS STRING) 
 END as macular_edema_in_center_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable/incomplete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Local' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Scatter only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Scatter + local' -- categorize numeric values
WHEN OPDDPPS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPPS AS STRING) 
 END as panret_photocoagulation_scar_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MA RX only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Grid only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'MA RX & Grid RX' -- categorize numeric values
WHEN OPDDFOC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDFOC AS STRING) 
 END as focal_photocoag_scars_for_me_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Early ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Late ARM' -- categorize numeric values
WHEN OPDDARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDARM AS STRING) 
 END as arm_3_severity_levels_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDPIGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPIGA AS STRING) 
 END as ret_pigmentary_abnorm_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDLARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDLARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDLARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDLARM AS STRING) 
 END as late_arm_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDGA AS STRING) 
 END as geographic_atrophy_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDEXU IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDEXU AS STRING) 
 END as exudative_arm_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAREX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAREX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDAREX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDAREX AS STRING) 
 END as excluded_for_arm_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Trauma' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Laser RX' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Vessel occlusion' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Macular dystrophy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Myopic degeneration' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Histoplasmosis/toxoplasmosis' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Inflammatory lesion' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Retinopathy of prematurity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'Non-ARM RPE abnormality' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'Non-ARM detachment' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Unknown etiology' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'Coloboma/staphyloma' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPDDREA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDREA AS STRING) 
 END as reason_for_arm_exclusion_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDHD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDHD AS STRING) 
 END as hard_distinct_drusen_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDD125 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDD125 AS STRING) 
 END as drusen_125_microns_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDD500 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDD500 AS STRING) 
 END as drusen_500_microns_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDASD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDASD AS STRING) 
 END as any_soft_drusen_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSDD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSDD AS STRING) 
 END as soft_distinct_drusen_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSID IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSID AS STRING) 
 END as soft_indistinct_drusen_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDIRP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDIRP AS STRING) 
 END as increased_retinal_pigment_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDRPE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDRPE AS STRING) 
 END as rpe_depigmentation_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDAGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDAGA AS STRING) 
 END as any_geographic_atrophy_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDPED IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPED AS STRING) 
 END as rpe_sensory_ret_detachment_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSNV IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSNV AS STRING) 
 END as subretinal_new_vessels_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSUBH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSUBH AS STRING) 
 END as subretinal_hemorrhage_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDSFS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSFS AS STRING) 
 END as subretinal_fibrous_scar_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDARMX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDARMX AS STRING) 
 END as treatment_for_arm_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDBCO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDBCO AS STRING) 
 END as retinal_artery_occlusion_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDBVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDBVO AS STRING) 
 END as retinal_branch_vein_occlusion_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDCVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDCVO AS STRING) 
 END as ret_central_vein_occlusion_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDAVN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDAVN AS STRING) 
 END as retinal_av_nicking_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDFAN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDFAN AS STRING) 
 END as focal_arteriolar_narrowing_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDHOLL IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDHOLL AS STRING) 
 END as hollenhorst_plaque_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDPPA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPPA AS STRING) 
 END as peripapillary_atrophy_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDASHY IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDASHY AS STRING) 
 END as asteroid_hyalosis_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDCHRA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDCHRA AS STRING) 
 END as chorioretinal_abnormality_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDDMACH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDMACH AS STRING) 
 END as macular_hole_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDCHN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDCHN AS STRING) 
 END as choroidal_nevus_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDOTRX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDOTRX AS STRING) 
 END as any_other_treatment_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDPOHS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDPOHS AS STRING) 
 END as histoplasmosis_syndrome_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDRDET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDRDET AS STRING) 
 END as retinal_detachment_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDSWR IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSWR AS STRING) 
 END as sw_cellophane_changes_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDSWRT IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDSWRT AS STRING) 
 END as sw_traction_changes_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDDOTHC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDOTHC AS STRING) 
 END as other_ocular_conditions_right_eye, 

CASE
WHEN OPDDVCDR IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDVCDR AS FLOAT64) 
 END as vertical_cup_disc_ratio_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Excellent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Good' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXDQUAL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDQUAL AS STRING) 
 END as quality_right_eye, 

CASE
WHEN OPXDRCDR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDRCDR AS FLOAT64) 
 END as vertical_cdr_re_read_images_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Possible' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Probable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Definite' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXDGLAU IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDGLAU AS STRING) 
 END as glaucoma_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Maybe' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXDHEME IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDHEME AS STRING) 
 END as disc_heme_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Small' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Average' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Large' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXDSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXDSIZE IS NULL THEN NULL 
ELSE SAFE_CAST(OPXDSIZE AS STRING) 
 END as size_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Maybe' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDDEXC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDEXC AS STRING) 
 END as excavation_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Inferior' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Superior' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDDNOT IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDNOT AS STRING) 
 END as notch_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDDTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDDTIL IS NULL THEN NULL 
ELSE SAFE_CAST(OPDDTIL AS STRING) 
 END as tilted_right_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No photos' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Incomplete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSCOMP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Complete' -- categorize numeric values
WHEN OPXSCOMP IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSCOMP AS STRING) 
 END as are_field_1_field_2_present_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF1 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Absent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF1 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present' -- categorize numeric values
WHEN OPXSF1 IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSF1 AS STRING) 
 END as field_1_present_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Good/fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Borderline' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF1FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN OPXSF1FO IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSF1FO AS STRING) 
 END as field_1_focus_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Absent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF2 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present' -- categorize numeric values
WHEN OPXSF2 IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSF2 AS STRING) 
 END as field_2_present_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Good/fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Borderline' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSF2FO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN OPXSF2FO IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSF2FO AS STRING) 
 END as field_2_focus_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Gradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Disc ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Part macula' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Macula ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Part disc & macula' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Disc & macula ungradable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGRBL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXSGRBL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSGRBL AS STRING) 
 END as gradability_of_images_left_eye, 

CASE
WHEN OPXSPMM IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPMM AS FLOAT64) 
 END as pupil_size_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHPR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHPR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHPR AS STRING) 
 END as photo_problems_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHIL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHIL AS STRING) 
 END as photo_prob_illumination_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHFD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHFD IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHFD AS STRING) 
 END as photo_prob_field_definition_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHHZ AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHHZ IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHHZ AS STRING) 
 END as photo_prob_haze_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHDD IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHDD AS STRING) 
 END as photo_prob_dust_dirt_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHLA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHLA IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHLA AS STRING) 
 END as photo_prob_lashes_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHAR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHAR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHAR AS STRING) 
 END as photo_prob_arc_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHRC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHRC IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHRC AS STRING) 
 END as photo_prob_red_channel_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSPHOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPXSPHOT IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSPHOT AS STRING) 
 END as photo_prob_other_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Non-diabetic retinal disease specific retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(13 AS FLOAT64),0) AS INT64) THEN 'Questionable retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(14 AS FLOAT64),0) AS INT64) THEN 'HE, SE, IRMA, VL but no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'HEM only, no MAS' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(20 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(31 AS FLOAT64),0) AS INT64) THEN 'Early NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(41 AS FLOAT64),0) AS INT64) THEN 'Moderate NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(51 AS FLOAT64),0) AS INT64) THEN 'Severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(60 AS FLOAT64),0) AS INT64) THEN 'Fibrous prolif. only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(61 AS FLOAT64),0) AS INT64) THEN 'No retinopathy but PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(62 AS FLOAT64),0) AS INT64) THEN 'MAS only + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(63 AS FLOAT64),0) AS INT64) THEN 'Early NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(64 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR + PRP laser' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(65 AS FLOAT64),0) AS INT64) THEN 'PR < HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(70 AS FLOAT64),0) AS INT64) THEN 'PR >= HRC' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(80 AS FLOAT64),0) AS INT64) THEN 'Total VH' -- categorize numeric values
WHEN OPDSRET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSRET AS STRING) 
 END as retinopathy_level_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No retinopathy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Mild NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate/severe NPR' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRL4 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'PR (Proliferative)' -- categorize numeric values
WHEN OPDSRL4 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSRL4 AS STRING) 
 END as exa_4_levels_retinopathy_severity_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSARMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSARMA AS STRING) 
 END as any_retinopathy_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MAS only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'HEM only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS < 2A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'HEM+MAS >= 2A' -- categorize numeric values
WHEN OPDSHMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSHMA AS STRING) 
 END as mas_hem_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSMA AS STRING) 
 END as retinal_microaneurysms_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHEM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSHEM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSHEM AS STRING) 
 END as retinal_blot_hemorrhages_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSHE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSHE AS STRING) 
 END as retinal_hard_exudate_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSE AS STRING) 
 END as retinal_soft_exudate_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 8A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRMA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 8A' -- categorize numeric values
WHEN OPDSIRMA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSIRMA AS STRING) 
 END as irma_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSVB AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSVB IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSVB AS STRING) 
 END as retinal_venous_beading_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 10A' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 10A' -- categorize numeric values
WHEN OPDSNVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSNVO AS STRING) 
 END as retinal_new_vessels_on_disc_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1/2 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNVE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1/2 Disc Area' -- categorize numeric values
WHEN OPDSNVE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSNVE AS STRING) 
 END as retinal_new_vessels_elsewhere_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'FPD only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'FPE only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRFP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'FPD + FPE' -- categorize numeric values
WHEN OPDSRFP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSRFP AS STRING) 
 END as retinal_fibrous_proliferation_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '< 1 Disc Area' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPHVH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '>= 1 Disc Area' -- categorize numeric values
WHEN OPDSPHVH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPHVH AS STRING) 
 END as pre_ret_vitreous_hemorrhage_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes, but not CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDSME IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSME AS STRING) 
 END as macular_edema_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Present and CSME' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'CSME with cysts' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMEC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN OPDSMEC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSMEC AS STRING) 
 END as macular_edema_in_center_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable/incomplete' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Local' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Scatter only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Scatter + local' -- categorize numeric values
WHEN OPDSPPS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPPS AS STRING) 
 END as panret_photocoagulation_scar_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'MA RX only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Grid only' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFOC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'MA RX & Grid RX' -- categorize numeric values
WHEN OPDSFOC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSFOC AS STRING) 
 END as focal_photocoag_scars_for_me_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Early ARM' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Late ARM' -- categorize numeric values
WHEN OPDSARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSARM AS STRING) 
 END as arm_3_severity_levels_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPIGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSPIGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPIGA AS STRING) 
 END as ret_pigmentary_abnorm_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSLARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSLARM AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSLARM IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSLARM AS STRING) 
 END as late_arm_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSGA AS STRING) 
 END as geographic_atrophy_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSEXU IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSEXU AS STRING) 
 END as exudative_arm_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAREX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAREX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSAREX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSAREX AS STRING) 
 END as excluded_for_arm_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Trauma' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Laser RX' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Vessel occlusion' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Macular dystrophy' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Myopic degeneration' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Histoplasmosis/toxoplasmosis' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Inflammatory lesion' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Retinopathy of prematurity' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(10 AS FLOAT64),0) AS INT64) THEN 'Non-ARM RPE abnormality' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(11 AS FLOAT64),0) AS INT64) THEN 'Non-ARM detachment' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(12 AS FLOAT64),0) AS INT64) THEN 'Unknown etiology' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(15 AS FLOAT64),0) AS INT64) THEN 'Other' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(16 AS FLOAT64),0) AS INT64) THEN 'Coloboma/staphyloma' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSREA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'No photos of eye' -- categorize numeric values
WHEN OPDSREA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSREA AS STRING) 
 END as reason_for_arm_exclusion_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSHD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSHD AS STRING) 
 END as hard_distinct_drusen_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSD125 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSD125 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSD125 AS STRING) 
 END as drusen_125_microns_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSD500 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSD500 IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSD500 AS STRING) 
 END as drusen_500_microns_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSASD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSASD AS STRING) 
 END as any_soft_drusen_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSDD AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSDD IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSDD AS STRING) 
 END as soft_distinct_drusen_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSID AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSID IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSID AS STRING) 
 END as soft_indistinct_drusen_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSIRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSIRP IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSIRP AS STRING) 
 END as increased_retinal_pigment_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRPE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSRPE IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSRPE AS STRING) 
 END as rpe_depigmentation_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAGA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSAGA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSAGA AS STRING) 
 END as any_geographic_atrophy_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPED AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSPED IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPED AS STRING) 
 END as rpe_sensory_ret_detachment_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSNV AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSNV IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSNV AS STRING) 
 END as subretinal_new_vessels_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSUBH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSUBH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSUBH AS STRING) 
 END as subretinal_hemorrhage_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSFS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSSFS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSFS AS STRING) 
 END as subretinal_fibrous_scar_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSARMX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSARMX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSARMX AS STRING) 
 END as treatment_for_arm_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBCO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSBCO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSBCO AS STRING) 
 END as retinal_artery_occlusion_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSBVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSBVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSBVO AS STRING) 
 END as retinal_branch_vein_occlusion_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCVO AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSCVO IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSCVO AS STRING) 
 END as ret_central_vein_occlusion_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSAVN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSAVN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSAVN AS STRING) 
 END as retinal_av_nicking_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSFAN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSFAN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSFAN AS STRING) 
 END as focal_arteriolar_narrowing_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSHOLL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSHOLL IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSHOLL AS STRING) 
 END as hollenhorst_plaque_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPPA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSPPA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPPA AS STRING) 
 END as peripapillary_atrophy_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSASHY AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSASHY IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSASHY AS STRING) 
 END as asteroid_hyalosis_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHRA AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSCHRA IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSCHRA AS STRING) 
 END as chorioretinal_abnormality_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSMACH AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN OPDSMACH IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSMACH AS STRING) 
 END as macular_hole_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSCHN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSCHN IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSCHN AS STRING) 
 END as choroidal_nevus_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTRX AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSOTRX IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSOTRX AS STRING) 
 END as any_other_treatment_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSPOHS AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSPOHS IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSPOHS AS STRING) 
 END as histoplasmosis_syndrome_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSRDET AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSRDET IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSRDET AS STRING) 
 END as retinal_detachment_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSSWR IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSWR AS STRING) 
 END as sw_cellophane_changes_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSSWRT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSSWRT IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSSWRT AS STRING) 
 END as sw_traction_changes_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Questionable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSOTHC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Yes, in center' -- categorize numeric values
WHEN OPDSOTHC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSOTHC AS STRING) 
 END as other_ocular_conditions_left_eye, 

CASE
WHEN OPDSVCDR IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSVCDR AS FLOAT64) 
 END as vertical_cup_disc_ratio_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Excellent' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Good' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Fair' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Poor' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSQUAL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXSQUAL IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSQUAL AS STRING) 
 END as quality_left_eye, 

CASE
WHEN OPXSRCDR IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSRCDR AS FLOAT64) 
 END as vertical_cdr_re_read_images_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Possible' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Probable' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Definite' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSGLAU AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXSGLAU IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSGLAU AS STRING) 
 END as glaucoma_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Maybe' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSHEME AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXSHEME IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSHEME AS STRING) 
 END as disc_heme_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'Small' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Average' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Large' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPXSSIZE AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPXSSIZE IS NULL THEN NULL 
ELSE SAFE_CAST(OPXSSIZE AS STRING) 
 END as size_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Maybe' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSEXC AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDSEXC IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSEXC AS STRING) 
 END as excavation_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Inferior' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Superior' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSNOT AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDSNOT IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSNOT AS STRING) 
 END as notch_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(OPDSTIL AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Ungradable' -- categorize numeric values
WHEN OPDSTIL IS NULL THEN NULL 
ELSE SAFE_CAST(OPDSTIL AS STRING) 
 END as tilted_left_eye, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ141 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Right' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ141 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Left' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ141 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN VIQ141 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ141 AS STRING) 
 END as which_eye, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_ophthalmology_retinal_imaging_examination') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/OPXRET_E.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/OPXRET_D.htm
*/
