SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'I have never had a drink of alcohol, other than a few sips' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '8 years old or younger' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '9 or 10 years old' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN '11 or 12 years old' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN '13 or 14 years old' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN '15 or 16 years old' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN '17 years old or older' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN ALQ010 IS NULL THEN NULL 
ELSE SAFE_CAST(ALQ010 AS STRING) 
 END as age_when_first_drank_alcohol, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN '0 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '1 or 2 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 9 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN '10 to 19 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN '20 to 39 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN '40 to 99 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN '100 or more days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD020 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN ALD020 IS NULL THEN NULL 
ELSE SAFE_CAST(ALD020 AS STRING) 
 END as days_drank_alcohol_over_lifetime, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN '0 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '1 or 2 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '3 to 5 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN '6 to 9 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN '10 to 19 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN '20 to 29 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'All 30 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN ALD030 IS NULL THEN NULL 
ELSE SAFE_CAST(ALD030 AS STRING) 
 END as days_drank_alcohol_over_past_30_days, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN '0 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '1 day' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '2 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN '3 to 5 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN '6 to 9 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN '10 to 19 days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN '20 or more days' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(ALD040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN ALD040 IS NULL THEN NULL 
ELSE SAFE_CAST(ALD040 AS STRING) 
 END as days_w_5_or_more_drinks_past_30_days, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_alcohol_use_ages_18_19_questionnaire') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2009-2010/ALQY_F.htm
*/
