SELECT
CASE
WHEN POOLID IS NULL THEN NULL 
ELSE SAFE_CAST(POOLID AS FLOAT64) 
 END as pool_id_number, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIAGENDR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Male' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIAGENDR AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Female' -- categorize numeric values
WHEN RIAGENDR IS NULL THEN NULL 
ELSE SAFE_CAST(RIAGENDR AS STRING) 
 END as gender, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDRAETN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Non-Hispanic White' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDRAETN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Non-Hispanic Black' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDRAETN AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Mexican American' -- categorize numeric values
WHEN RIDRAETN IS NULL THEN NULL 
ELSE SAFE_CAST(RIDRAETN AS STRING) 
 END as ethnicity, 

CASE
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN '6 Yrs. to 11 Yrs.' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN '12 Yrs. to 19 Yrs.' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN '20 Yrs. to 39 Yrs.' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN '40 Yrs. to 59 Yrs.' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN '60 Yrs. to 150 Yrs.' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(RIDAGGRP AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(-1 AS FLOAT64),0) AS INT64) THEN '3 Yrs. to 5 Yrs.' -- categorize numeric values
WHEN RIDAGGRP IS NULL THEN NULL 
ELSE SAFE_CAST(RIDAGGRP AS STRING) 
 END as age_group, 

CASE
WHEN RIANSMP IS NULL THEN NULL 
ELSE SAFE_CAST(RIANSMP AS FLOAT64) 
 END as number_of_samples_included_in_pool, 

CASE
WHEN SSHCB IS NULL THEN NULL 
ELSE SAFE_CAST(SSHCB AS FLOAT64) 
 END as hcb, 

CASE
WHEN SSBHC IS NULL THEN NULL 
ELSE SAFE_CAST(SSBHC AS FLOAT64) 
 END as b_hcch, 

CASE
WHEN SSGHC IS NULL THEN NULL 
ELSE SAFE_CAST(SSGHC AS FLOAT64) 
 END as g_hcch, 

CASE
WHEN SSOXY IS NULL THEN NULL 
ELSE SAFE_CAST(SSOXY AS FLOAT64) 
 END as oxychlor, 

CASE
WHEN SSTNA IS NULL THEN NULL 
ELSE SAFE_CAST(SSTNA AS FLOAT64) 
 END as t_nona, 

CASE
WHEN SSPDE IS NULL THEN NULL 
ELSE SAFE_CAST(SSPDE AS FLOAT64) 
 END as pp_dde7, 

CASE
WHEN SSODT IS NULL THEN NULL 
ELSE SAFE_CAST(SSODT AS FLOAT64) 
 END as op_ddt, 

CASE
WHEN SSPDT IS NULL THEN NULL 
ELSE SAFE_CAST(SSPDT AS FLOAT64) 
 END as pp_ddt, 

CASE
WHEN SSMIR IS NULL THEN NULL 
ELSE SAFE_CAST(SSMIR AS FLOAT64) 
 END as mirex, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_pesticides_organochlorine_metabolites_serum_pooled_samples_surplus_laboratory') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/SSPST_B.htm
*/
