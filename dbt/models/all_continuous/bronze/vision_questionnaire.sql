SELECT
SEQN as respondent_sequence_number, -- could not identify transformation logic 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ010 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ010 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ010 AS STRING) 
 END as can_see_light, 

CASE
    WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ017 AS FLOAT64),0) AS INT64) AS STRING) = '1' THEN 'Yes' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ017 AS FLOAT64),0) AS INT64) AS STRING) = '2' THEN 'No' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ017 AS FLOAT64),0) AS INT64) AS STRING) = '7' THEN 'Refused' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ017 AS FLOAT64),0) AS INT64) AS STRING) = '9' THEN 'Dont know' -- categorize string values 
WHEN VIQ017 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ017 AS STRING) 
 END as blind_in_both_eyes, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Excellent,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Good,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Fair,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Poor, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Very poor?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ031 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ031 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ031 AS STRING) 
 END as general_condition_of_eyesight, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A little of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Most of the time, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'All of the time?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ041 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ041 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ041 AS STRING) 
 END as time_worrying_about_eyesight, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ051A IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ051A AS STRING) 
 END as difficulty_reading_ordinary_newsprint, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ051B IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ051B AS STRING) 
 END as difficulty_with_up_close_work_or_chores, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ051C IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ051C AS STRING) 
 END as difficulty_seeing_steps_curbs_dim_light, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ051D IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ051D AS STRING) 
 END as difficulty_noticing_objects_to_side, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ051E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ051E IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ051E AS STRING) 
 END as difficulty_findng_object_on_crowdedshelf, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Never drove' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ056 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ056 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ056 AS STRING) 
 END as difficulty_drivng_daytime_familiar_place, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A little of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Most of the time, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'All of the time?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ061 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ061 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ061 AS STRING) 
 END as vision_limits_how_long_can_do_activities, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ071 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ071 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ071 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ071 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont Know' -- categorize numeric values
WHEN VIQ071 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ071 AS STRING) 
 END as ever_had_a_cataract_operation, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ081 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Right eye' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ081 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Left eye' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ081 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ081 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ081 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ081 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ081 AS STRING) 
 END as operation_in_right_left_or_both_eyes, 

CASE
    WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ090 AS FLOAT64),0) AS INT64) AS STRING) = '1' THEN 'Yes' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ090 AS FLOAT64),0) AS INT64) AS STRING) = '2' THEN 'No' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ090 AS FLOAT64),0) AS INT64) AS STRING) = '7' THEN 'Refused' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ090 AS FLOAT64),0) AS INT64) AS STRING) = '9' THEN 'Dont know' -- categorize string values 
WHEN VIQ090 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ090 AS STRING) 
 END as ever_told_had_glaucoma, 

CASE
    WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ100 AS FLOAT64),0) AS INT64) AS STRING) = '1' THEN 'Right eye' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ100 AS FLOAT64),0) AS INT64) AS STRING) = '2' THEN 'Left eye' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ100 AS FLOAT64),0) AS INT64) AS STRING) = '3' THEN 'Both' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ100 AS FLOAT64),0) AS INT64) AS STRING) = '7' THEN 'Refused' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ100 AS FLOAT64),0) AS INT64) AS STRING) = '9' THEN 'Dont know' -- categorize string values 
WHEN VIQ100 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ100 AS STRING) 
 END as glaucoma_in_which_eye, 

CASE
    WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ310 AS FLOAT64),0) AS INT64) AS STRING) = '1' THEN 'Yes' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ310 AS FLOAT64),0) AS INT64) AS STRING) = '2' THEN 'No' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ310 AS FLOAT64),0) AS INT64) AS STRING) = '7' THEN 'Refused' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ310 AS FLOAT64),0) AS INT64) AS STRING) = '9' THEN 'Dont know' -- categorize string values 
WHEN VIQ310 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ310 AS STRING) 
 END as told_had_macular_degeneration, 

CASE
    WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ320 AS FLOAT64),0) AS INT64) AS STRING) = '1' THEN 'Right eye' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ320 AS FLOAT64),0) AS INT64) AS STRING) = '2' THEN 'Left eye' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ320 AS FLOAT64),0) AS INT64) AS STRING) = '3' THEN 'Both' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ320 AS FLOAT64),0) AS INT64) AS STRING) = '7' THEN 'Refused' -- categorize string values 
WHEN SAFE_CAST(SAFE_CAST(ROUND(SAFE_CAST(VIQ320 AS FLOAT64),0) AS INT64) AS STRING) = '9' THEN 'Dont know' -- categorize string values 
WHEN VIQ320 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ320 AS STRING) 
 END as macular_degeneration_in_which_eye, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Excellent,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Good,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Fair,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Poor, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Very poor?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ030 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ030 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ030 AS STRING) 
 END as general_condition_of_eyesight_VIQ030, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A little of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Most of the time, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'All of the time?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ040 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ040 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ040 AS STRING) 
 END as time_worrying_about_eyesight_VIQ040, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050A AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ050A IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ050A AS STRING) 
 END as difficulty_reading_ordinary_newsprint_VIQ050A, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050B AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ050B IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ050B AS STRING) 
 END as difficulty_with_up_close_work_or_chores_VIQ050B, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050C AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ050C IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ050C AS STRING) 
 END as difficulty_seeing_steps_curbs_dim_light_VIQ050C, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050D AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ050D IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ050D AS STRING) 
 END as difficulty_noticing_objects_to_side_VIQ050D, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ050E AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ050E IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ050E AS STRING) 
 END as difficulty_findng_object_on_crowdedshelf_VIQ050E, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'No difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'A little difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Moderate difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'Extreme difficulty' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(5 AS FLOAT64),0) AS INT64) THEN 'Unable to do because of eyesight' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(6 AS FLOAT64),0) AS INT64) THEN 'Does not do this for other reasons' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Never drove' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(77 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ055 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(99 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ055 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ055 AS STRING) 
 END as difficulty_drivng_daytime_familiar_place_VIQ055, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(0 AS FLOAT64),0) AS INT64) THEN 'None of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'A little of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Some of the time,' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Most of the time, or' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(4 AS FLOAT64),0) AS INT64) THEN 'All of the time?' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ060 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ060 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ060 AS STRING) 
 END as vision_limits_how_long_can_do_activities_VIQ060, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ070 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Yes' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ070 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'No' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ070 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ070 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ070 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ070 AS STRING) 
 END as ever_had_a_cataract_operation_VIQ070, 

CASE
    WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ080 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(1 AS FLOAT64),0) AS INT64) THEN 'Right eye' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ080 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(2 AS FLOAT64),0) AS INT64) THEN 'Left eye' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ080 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(3 AS FLOAT64),0) AS INT64) THEN 'Both' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ080 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(7 AS FLOAT64),0) AS INT64) THEN 'Refused' -- categorize numeric values
WHEN SAFE_CAST(ROUND(SAFE_CAST(VIQ080 AS FLOAT64),0) AS INT64) = SAFE_CAST(ROUND(SAFE_CAST(9 AS FLOAT64),0) AS INT64) THEN 'Dont know' -- categorize numeric values
WHEN VIQ080 IS NULL THEN NULL 
ELSE SAFE_CAST(VIQ080 AS STRING) 
 END as operation_in_right_left_or_both_eyes_VIQ080, 

start_year,
end_year,
last_updated,
published_date,
parquet_filename,
data_file_url,
doc_file_url,
dataset,
 FROM {{ ref('stg_vision_questionnaire') }}

/* 
Docs utilized to generate this SQL can be found at:
https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/VIQ_E.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/VIQ_D.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/VIQ_C.htm
https://wwwn.cdc.gov/Nchs/Nhanes/2001-2002/VIQ_B.htm
https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/VIQ.htm
*/
